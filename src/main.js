/**
 * –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤—ã—Ä—É—á–∫–∏ –æ—Ç –æ–¥–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–∞
 * @param purchase –∑–∞–ø–∏—Å—å –æ –ø–æ–∫—É–ø–∫–µ (–∏–∑ items –≤ —á–µ–∫–µ)
 * @param _product –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ (–ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ –æ—Å—Ç–∞–≤–ª–µ–Ω –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
 * @returns {number} –≤—ã—Ä—É—á–∫–∞ —Å —É—á–µ—Ç–æ–º —Å–∫–∏–¥–∫–∏
 */
function calculateSimpleRevenue(purchase, _product) {
  // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–æ–∫—É–ø–∫–∏: —Å–∫–∏–¥–∫—É –≤ %, —Ü–µ–Ω—É –ø—Ä–æ–¥–∞–∂–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
  const { discount, sale_price, quantity } = purchase;

  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç —Å–∫–∏–¥–∫–∏ –≤ –¥–µ—Å—è—Ç–∏—á–Ω—É—é –¥—Ä–æ–±—å
  // –ù–∞–ø—Ä–∏–º–µ—Ä: 10% —Å–∫–∏–¥–∫–∞ ‚Üí 10/100 = 0.1
  const discountDecimal = discount / 100;

  // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ü–µ–Ω—ã –ø–æ—Å–ª–µ —Å–∫–∏–¥–∫–∏
  // –ù–∞–ø—Ä–∏–º–µ—Ä: 10% —Å–∫–∏–¥–∫–∞ ‚Üí 1 - 0.1 = 0.9 (–æ—Å—Ç–∞–µ—Ç—Å—è 90% –æ—Ç —Ü–µ–Ω—ã)
  const priceAfterDiscount = 1 - discountDecimal;

  // –í—ã—Ä—É—á–∫–∞ = —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ √ó –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ √ó –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–∫–∏–¥–∫–∏
  const revenue = sale_price * quantity * priceAfterDiscount;

  return revenue;
}

/**
 * –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –±–æ–Ω—É—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∑–∏—Ü–∏–∏ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ
 * @param index –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–µ (0 - –ø–µ—Ä–≤—ã–π, 1 - –≤—Ç–æ—Ä–æ–π –∏ —Ç.–¥.)
 * @param total –æ–±—â–µ–µ —á–∏—Å–ª–æ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤
 * @param seller –∫–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞ —Å –µ–≥–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
 * @returns {number} —Ä–∞–∑–º–µ—Ä –±–æ–Ω—É—Å–∞ –≤ —Ä—É–±–ª—è—Ö
 */
function calculateBonusByProfit(index, total, seller) {
  // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–∏–±—ã–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
  const { profit } = seller;

  // –ë–æ–Ω—É—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:
  // ü•á 1 –º–µ—Å—Ç–æ - 15% –æ—Ç –ø—Ä–∏–±—ã–ª–∏
  if (index === 0) {
    return profit * 0.15;
  }
  // ü•à 2 –∏ 3 –º–µ—Å—Ç–∞ - 10% –æ—Ç –ø—Ä–∏–±—ã–ª–∏
  else if (index === 1 || index === 2) {
    return profit * 0.1;
  }
  // üòû –ü–æ—Å–ª–µ–¥–Ω–µ–µ –º–µ—Å—Ç–æ - 0% –±–æ–Ω—É—Å–∞
  // total - 1 –ø–æ—Ç–æ–º—É —á—Ç–æ –∏–Ω–¥–µ–∫—Å—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å 0
  else if (index === total - 1) {
    return 0;
  }
  // üëç –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ - 5% –æ—Ç –ø—Ä–∏–±—ã–ª–∏
  else {
    return profit * 0.05;
  }
}

/**
 * –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂
 * @param data –æ–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö, —Ç–æ–≤–∞—Ä–∞—Ö, –ø—Ä–æ–¥–∞–≤—Ü–∞—Ö –∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è—Ö
 * @param options –æ–±—ä–µ–∫—Ç —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
 * @returns {Array} –º–∞—Å—Å–∏–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–æ–¥–∞–≤—Ü–∞—Ö –∏ –∏—Ö –±–æ–Ω—É—Å–∞—Ö
 */
function analyzeSalesData(data, options) {
  // ===========================================
  // –ü–†–û–í–ï–†–ö–ê –í–•–û–î–ù–´–• –î–ê–ù–ù–´–•
  // ===========================================

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –≤–æ–æ–±—â–µ –ø–µ—Ä–µ–¥–∞–Ω—ã
  if (!data) {
    throw new Error("–î–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ —Ñ—É–Ω–∫—Ü–∏—é");
  }

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–∞—Å—Å–∏–≤—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –Ω–µ –ø—É—Å—Ç—ã–µ
  if (!Array.isArray(data.sellers) || data.sellers.length === 0) {
    throw new Error("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–≤—Ü–∞—Ö –∏–ª–∏ –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç");
  }

  if (!Array.isArray(data.products) || data.products.length === 0) {
    throw new Error("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ–≤–∞—Ä–∞—Ö –∏–ª–∏ –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç");
  }

  if (
    !Array.isArray(data.purchase_records) ||
    data.purchase_records.length === 0
  ) {
    throw new Error("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∏–ª–∏ –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç");
  }

  // ===========================================
  // –ü–†–û–í–ï–†–ö–ê –ù–ê–õ–ò–ß–ò–Ø –û–ü–¶–ò–ô
  // ===========================================

  // –ò–∑–≤–ª–µ–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ –∏–∑ –æ–ø—Ü–∏–π
  const { calculateRevenue, calculateBonus } = options;

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–Ω—ã
  if (!calculateRevenue || !calculateBonus) {
    throw new Error("–ù–µ –ø–µ—Ä–µ–¥–∞–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ –≤ –æ–ø—Ü–∏—è—Ö");
  }

  // ===========================================
  // –ü–û–î–ì–û–¢–û–í–ö–ê –ü–†–û–ú–ï–ñ–£–¢–û–ß–ù–´–• –î–ê–ù–ù–´–• –î–õ–Ø –°–ë–û–†–ê –°–¢–ê–¢–ò–°–¢–ò–ö–ò
  // ===========================================

  // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥–∞–≤—Ü—É
  const sellerStats = data.sellers.map((seller) => {
    return {
      // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
      id: seller.id,
      name: `${seller.first_name} ${seller.last_name}`,

      // –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–Ω–∞—á–∏–Ω–∞–µ–º —Å 0)
      revenue: 0, // –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞
      profit: 0, // –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å
      sales_count: 0, // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂

      // –î–ª—è —É—á–µ—Ç–∞ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
      products_sold: {}, // –û–±—ä–µ–∫—Ç –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞: { 'SKU_001': 5, 'SKU_002': 3 }

      // –î–ª—è –∏—Ç–æ–≥–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞
      bonus: 0, // –ë–æ–Ω—É—Å (—Ä–∞—Å—Å—á–∏—Ç–∞–µ–º –ø–æ–∑–∂–µ)
      top_products: [], // –¢–æ–ø-10 —Ç–æ–≤–∞—Ä–æ–≤ (—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–∑–∂–µ)
    };
  });

  // ===========================================
  // –ò–ù–î–ï–ö–°–ê–¶–ò–Ø –ü–†–û–î–ê–í–¶–û–í –ò –¢–û–í–ê–†–û–í –î–õ–Ø –ë–´–°–¢–†–û–ì–û –î–û–°–¢–£–ü–ê
  // ===========================================

  // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –ø–æ ID
  const sellerIndex = {};
  sellerStats.forEach((seller) => {
    sellerIndex[seller.id] = seller;
  });

  // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É (SKU)
  const productIndex = {};
  data.products.forEach((product) => {
    productIndex[product.sku] = product;
  });

  // ===========================================
  // –†–ê–°–ß–ï–¢ –í–´–†–£–ß–ö–ò –ò –ü–†–ò–ë–´–õ–ò –î–õ–Ø –ö–ê–ñ–î–û–ì–û –ü–†–û–î–ê–í–¶–ê
  // ===========================================

  // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ –∑–∞–ø–∏—Å–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö (—á–µ–∫–∏)
  data.purchase_records.forEach((record) => {
    // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–æ–¥–∞–≤—Ü–∞ –ø–æ ID –∏–∑ —á–µ–∫–∞
    const seller = sellerIndex[record.seller_id];

    // –ï—Å–ª–∏ –ø—Ä–æ–¥–∞–≤–µ—Ü –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —ç—Ç—É –∑–∞–ø–∏—Å—å
    if (!seller) {
      console.warn(`–ü—Ä–æ–¥–∞–≤–µ—Ü —Å ID ${record.seller_id} –Ω–µ –Ω–∞–π–¥–µ–Ω`);
      return; // –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–ø–∏—Å–∏
    }

    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ–¥–∞–∂ —É —ç—Ç–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞
    seller.sales_count += 1;

    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä –≤ —á–µ–∫–µ
    record.items.forEach((item) => {
      // –ù–∞—Ö–æ–¥–∏–º —Ç–æ–≤–∞—Ä –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É
      const product = productIndex[item.sku];

      // –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
      if (!product) {
        console.warn(`–¢–æ–≤–∞—Ä —Å –∞—Ä—Ç–∏–∫—É–ª–æ–º ${item.sku} –Ω–µ –Ω–∞–π–¥–µ–Ω`);
        return; // –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ç–æ–≤–∞—Ä—É
      }

      // –†–ê–°–ß–ï–¢ –§–ò–ù–ê–ù–°–û–í–´–• –ü–û–ö–ê–ó–ê–¢–ï–õ–ï–ô:

      // 1. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—ã—Ä—É—á–∫—É –æ—Ç —ç—Ç–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ —Å —É—á–µ—Ç–æ–º —Å–∫–∏–¥–∫–∏
      const revenue = calculateRevenue(item, product);

      // 2. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (–∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Ç–æ–≤–∞—Ä)
      const cost = product.purchase_price * item.quantity;

      // 3. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏–±—ã–ª—å: –≤—ã—Ä—É—á–∫–∞ –º–∏–Ω—É—Å —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å
      const profit = revenue - cost;

      // –û–ë–ù–û–í–õ–Ø–ï–ú –°–¢–ê–¢–ò–°–¢–ò–ö–£ –ü–†–û–î–ê–í–¶–ê:

      // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã—Ä—É—á–∫—É –∏ –ø—Ä–∏–±—ã–ª—å –æ—Ç —ç—Ç–æ–π –ø—Ä–æ–¥–∞–∂–∏ –∫ –æ–±—â–∏–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º
      seller.revenue += revenue;
      seller.profit += profit;

      // –£–ß–ò–¢–´–í–ê–ï–ú –ü–†–û–î–ê–ù–ù–´–ï –¢–û–í–ê–†–´:

      // –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä —Å —Ç–∞–∫–∏–º –∞—Ä—Ç–∏–∫—É–ª–æ–º –µ—â–µ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–ª—Å—è —É –ø—Ä–æ–¥–∞–≤—Ü–∞
      if (!seller.products_sold[item.sku]) {
        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å —Å –Ω–∞—á–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º 0
        seller.products_sold[item.sku] = 0;
      }

      // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü —ç—Ç–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
      seller.products_sold[item.sku] += item.quantity;
    });
  });

  // ===========================================
  // –°–û–†–¢–ò–†–û–í–ö–ê –ü–†–û–î–ê–í–¶–û–í –ü–û –ü–†–ò–ë–´–õ–ò
  // ===========================================

  // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –ø–æ —É–±—ã–≤–∞–Ω–∏—é –ø—Ä–∏–±—ã–ª–∏ (–æ—Ç —Å–∞–º–æ–π –±–æ–ª—å—à–æ–π –∫ —Å–∞–º–æ–π –º–∞–ª–µ–Ω—å–∫–æ–π)
  sellerStats.sort((sellerA, sellerB) => {
    // –ï—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞ B –±–æ–ª—å—à–µ –ø—Ä–∏–±—ã–ª–∏ –ø—Ä–æ–¥–∞–≤—Ü–∞ A,
    // —Ç–æ sellerB –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–¥ sellerA –≤ –º–∞—Å—Å–∏–≤–µ
    return sellerB.profit - sellerA.profit;
  });

  // ===========================================
  // –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï –ü–†–ï–ú–ò–ô –ù–ê –û–°–ù–û–í–ï –†–ê–ù–ñ–ò–†–û–í–ê–ù–ò–Ø
  // ===========================================

  // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤
  sellerStats.forEach((seller, index) => {
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –±–æ–Ω—É—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∑–∏—Ü–∏–∏ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ
    seller.bonus = calculateBonus(index, sellerStats.length, seller);

    // –§–û–†–ú–ò–†–£–ï–ú –¢–û–ü-10 –°–ê–ú–´–• –ü–†–û–î–ê–í–ê–ï–ú–´–• –¢–û–í–ê–†–û–í:

    // 1. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ä–µ–∫—Ç products_sold –≤ –º–∞—Å—Å–∏–≤ –ø–∞—Ä [–∞—Ä—Ç–∏–∫—É–ª, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ]
    const productEntries = Object.entries(seller.products_sold);

    // 2. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã
    const productsArray = productEntries.map(([sku, quantity]) => {
      return {
        sku: sku, // –∞—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞
        quantity: quantity, // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü
      };
    });

    // 3. –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (—Å–∞–º—ã–µ –ø—Ä–æ–¥–∞–≤–∞–µ–º—ã–µ - –ø–µ—Ä–≤—ã–º–∏)
    productsArray.sort((productA, productB) => {
      return productB.quantity - productA.quantity;
    });

    // 4. –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 10 —Ç–æ–≤–∞—Ä–æ–≤ (—Ç–æ–ø-10)
    seller.top_products = productsArray.slice(0, 10);
  });

  // ===========================================
  // –ü–û–î–ì–û–¢–û–í–ö–ê –ò–¢–û–ì–û–í–û–ô –ö–û–õ–õ–ï–ö–¶–ò–ò –° –ù–£–ñ–ù–´–ú–ò –ü–û–õ–Ø–ú–ò
  // ===========================================

  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞—à—É –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞
  const result = sellerStats.map((seller) => {
    return {
      seller_id: seller.id, // ID –ø—Ä–æ–¥–∞–≤—Ü–∞
      name: seller.name, // –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è
      revenue: +seller.revenue.toFixed(2), // –í—ã—Ä—É—á–∫–∞ (–æ–∫—Ä—É–≥–ª–µ–Ω–Ω–∞—è –¥–æ 2 –∑–Ω–∞–∫–æ–≤)
      profit: +seller.profit.toFixed(2), // –ü—Ä–∏–±—ã–ª—å (–æ–∫—Ä—É–≥–ª–µ–Ω–Ω–∞—è –¥–æ 2 –∑–Ω–∞–∫–æ–≤)
      sales_count: seller.sales_count, // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂ (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)
      top_products: seller.top_products, // –¢–æ–ø-10 –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
      bonus: +seller.bonus.toFixed(2), // –ë–æ–Ω—É—Å (–æ–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–π –¥–æ 2 –∑–Ω–∞–∫–æ–≤)
    };
  });

  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  return result;
}
